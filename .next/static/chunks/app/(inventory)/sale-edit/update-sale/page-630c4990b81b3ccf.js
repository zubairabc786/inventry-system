(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{5998:function(e,a,t){Promise.resolve().then(t.bind(t,3655))},3655:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return i}});var c=t(7437),n=t(2265),r=t(8078),d=t(1396),l=t.n(d);function i(){let[e,a]=(0,n.useState)(!1);console.log("isSubmitting",e);let[t,d]=(0,n.useState)([]),[i,s]=(0,n.useState)([]),[u,o]=(0,n.useState)([]),[f,b]=(0,n.useState)(new Date().toISOString().split("T")[0]),[p,h]=(0,n.useState)("");function x(e,a,t){let c=[...u];if("product_code"===a){let a=i.find(e=>e.product_code===t);c[e].product_code=t,c[e].price=(null==a?void 0:a.purchase_price)||0}else c[e][a]=t;o(c)}async function m(t){if(t.preventDefault(),e)return;if(a(!0),!p.trim()||!f.trim()||!u.length){alert("Input cannot be empty"),a(!1);return}let c=new FormData;c.append("doc_type","PV"),c.append("purchase_code",p),c.append("dated",f),c.append("items",JSON.stringify(u));try{let{doc_id:e}=await (0,r.xg)(c);e&&(alert("Saved with doc_id: "+e),o([]),d([]),b(new Date().toISOString().split("T")[0]))}catch(e){console.error("Error saving purchase:",e),alert("Failed to save purchase. Please try again.")}finally{a(!1)}}(0,n.useEffect)(()=>{!async function(){let{coaList:e,productList:a}=await (0,r.Ey)();d(e),s(a)}()},[]),(0,n.useEffect)(()=>{console.log("isSubmitting changed to:",e)},[e]);let g=u.reduce((e,a)=>e+a.quantity*a.price,0);return console.log("grandTotal",g),(0,c.jsxs)("form",{onSubmit:m,className:"  p-4 max-w-5xl space-y-4 mx-auto",children:[(0,c.jsx)("h1",{className:"text-4xl md:text-2xl lg:text-5xl font-extrabold tracking-tight text-center animate-fade-in animate-color-shift",children:(0,c.jsx)("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-500 via-green-500 to-purple-500",children:"Purchase Sheet"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block",children:"Purchase Code:"}),(0,c.jsxs)("select",{onChange:e=>h(e.target.value),className:"border p-1",children:[(0,c.jsx)("option",{value:"",children:"Select"}),t.map(e=>(0,c.jsxs)("option",{value:e.account_code,children:[e.account_code," - ",e.account_name]},e.account_code))]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block",children:"Date:"}),(0,c.jsx)("input",{type:"date",value:f,onChange:e=>b(e.target.value),className:"border p-1"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{type:"button",onClick:function(){o([...u,{product_code:"",quantity:0,price:0,remarks:""}])},className:"bg-blue-500 text-white px-3 py-1 rounded",children:"+ Add Item"}),(0,c.jsxs)("div",{className:"text-left grid grid-cols-6 pl-2 gap-2",children:[(0,c.jsx)("label",{children:"Product Name"}),(0,c.jsx)("label",{children:"Qty"}),(0,c.jsx)("label",{children:"Price"}),(0,c.jsx)("label",{children:"Remarks"}),(0,c.jsx)("label",{children:"Total"})]}),u.map((e,a)=>(0,c.jsxs)("div",{className:"grid grid-cols-6 gap-2 mt-2",children:[(0,c.jsxs)("select",{value:e.product_code,onChange:e=>x(a,"product_code",e.target.value),className:"border p-1",children:[(0,c.jsx)("option",{value:"",children:"Item"}),i.map(e=>(0,c.jsxs)("option",{value:e.product_code,children:[e.product_code," - ",e.product_name]},e.product_code))]}),(0,c.jsx)("input",{type:"number",placeholder:"Qty",value:e.quantity,onChange:e=>x(a,"quantity",e.target.value),className:"border p-1"}),(0,c.jsx)("input",{type:"number",placeholder:"Price",value:e.price,readOnly:!0,onChange:e=>x(a,"price",e.target.value),className:"border p-1"}),(0,c.jsx)("input",{type:"text",placeholder:"Remarks",value:e.remarks,onChange:e=>x(a,"remarks",e.target.value),className:"border p-1"}),(0,c.jsx)("div",{className:"pl-4 bg-gray-200",children:e.quantity*e.price||0}),(0,c.jsx)("button",{type:"button",onClick:()=>{o(u.filter((e,t)=>t!==a))},className:"bg-red-500 text-white rounded px-2 py-1",children:"Delete"})]},a))]}),(0,c.jsx)("div",{className:" flex justify-end w-full  ",children:(0,c.jsxs)("div",{className:"w-8 ",children:[(0,c.jsx)("label",{htmlFor:"",className:"block",children:"GrandTotal"}),(0,c.jsx)("span",{className:"bg-gray-300 p-1 ",children:g})]})}),(0,c.jsx)("button",{type:"submit",disabled:e,className:"bg-green-600 text-white px-4 py-2 rounded",children:e?"Saving...":"Save Purchase"}),(0,c.jsx)("div",{className:"flex justify-center mt-4 bg-blue-900",children:(0,c.jsx)(l(),{href:"/purchase-detail",className:"text-white p-2",children:"Go To Purchase Details"})})]})}},8078:function(e,a,t){"use strict";t.d(a,{$K:function(){return j},C$:function(){return l},Do:function(){return N},Ey:function(){return o},K6:function(){return h},Ks:function(){return d},OD:function(){return v},OG:function(){return b},Xp:function(){return s},Y$:function(){return $},cY:function(){return r},dH:function(){return y},gM:function(){return m},ie:function(){return f},oN:function(){return g},r4:function(){return n},ry:function(){return i},vA:function(){return p},xg:function(){return u},zV:function(){return x}}),t(5355);var c=t(1162),n=(0,c.$)("091d73d95320b036c57ef7d96d5e05ab7311a613"),r=(0,c.$)("cb4f4b774b9d88b3c534434328e16fcbad7a9269"),d=(0,c.$)("6ca0d13716ec2e1de55299573eab2a5058b37b08"),l=(0,c.$)("0f43a19a198e50d66f8812d5c82ec5ce51a2f043"),i=(0,c.$)("42fa3d8a19af81e5b592d3f23d853b67b72711d9"),s=(0,c.$)("e96912272c67976ddd4249bc8ffb96d731a7bf50"),u=(0,c.$)("8dc13c579d855e7071caf38e0aca70c0929d46eb"),o=(0,c.$)("c93ab26931ca5734d5e62318905e2804181cb60a");(0,c.$)("4c809af6775a8bcc983e051c557925a929b83421"),(0,c.$)("f2b90191f662ed14e70f2489c6a5fa375a55291d");var f=(0,c.$)("f52e47321e04054eca09b13a02ffa54c11e5ff02"),b=(0,c.$)("b93a02faedcd35fa57d2264e59e1e5410f2f7040"),p=(0,c.$)("f5b6016afb0036b672a9f51a7dabee39e721b800");(0,c.$)("d471c79f1681404af2366afb867205d40261192f");var h=(0,c.$)("af28085dac97ece90a9b47c2b651a736367cd566"),x=(0,c.$)("382cffa6fab359d0e100dfc1f8ca2ce0d621a801"),m=(0,c.$)("c581f3dd1f7d38ed7cae01b669acf535a04e3572"),g=(0,c.$)("4e687357918295a68f0b3d1b4d5434d1c3f82501"),v=(0,c.$)("52c194031b9970623c85b0a24c424c974c8cefec"),j=(0,c.$)("51ce2a1c9289abbc06b012664d6a439ad3deb4e6"),y=(0,c.$)("11a235eb1d04e541768b31e6f21a7d7a17a567a9");(0,c.$)("134ebd23ed5d7398731a79af0c130c1ba5e720b1");var $=(0,c.$)("c18c8b12a7e0de24f9d14dfe249593a85ff347b9"),N=(0,c.$)("09a35ed028ace98a546c7941d82389dedd03aca0");(0,c.$)("da7ec353ccbd534acbfb4a33d31ef910814f3f10"),(0,c.$)("39c789efd65e411bdad465608ed5b232e577a748")},1162:function(e,a,t){"use strict";Object.defineProperty(a,"$",{enumerable:!0,get:function(){return n}});let c=t(5355);function n(e){let{createServerReference:a}=t(6671);return a(e,c.callServer)}},1396:function(e,a,t){e.exports=t(5250)}},function(e){e.O(0,[672,971,938,744],function(){return e(e.s=5998)}),_N_E=e.O()}]);